---
layout: post
title: (자료구조)Map 실습
categories: [data]
excerpt: ' '
comments: false
share: false
tags: data
date: 2019-05-22
---

## 실습 1

### 1) 학생정보(StudentInfo)를 저장하고 검색하는 Hash Table을 다음 조건에 맞게 구현하시오

#### 구현 조건

- StudentId(학번)을 key로 사용함
- Data는 이름(한글 또는 영어)
- Bucket array는 java.util.ArrayList를 사용하여 구현
- Bucket array의 크기는 BucketCapacity 변수에 저장
- Hash Function은 component summation 및 division 압축방법(mod)을 사용하여 구현
- Collision 처리는 Separate Chaining을 적용(ArrayList 사용하여 구현, 메모리 최적화 불필요)
- main() 함수를 작성하여 초기 크기(initialCapacity)가 13인 hash table을 생성하고 임의의 학생 10명을 추가하시오

- ADT란 Abstract Data Type를 말한다.

#### StudentInfo.java

```java
package map;

public class StudentInfo {
	private String studentID;
	private String studentName;

	//생성자
	public StudentInfo(String id, String name){
		this.studentID = id;
		this.studentName = name;
	}

	public String getStudentID() {
		return studentID;
	}
	public void setStudentID(String studentID) {
		this.studentID = studentID;
	}
	public String getStudentName() {
		return studentName;
	}
	public void setStudentName(String studentName) {
		this.studentName = studentName;
	}


}

```

#### hashFunc 함수

![No Image](/assets/posts/20190522/1.png)
generation과 compresion 둘다 해줘야 한다.

- << / >> 각 연산자는 지정된 숫자만큼 왼쪽 오른쪽 이동.
- \>>> 비트 값들을 오른쪽을 이동시킨 후에 왼쪽의 빈공간은 모두 0으로 채운다.
- | : or 연산자.
- `h = (h << 5 ) | (h >>> 27);`
- `(h>>>27) : 0000000000000000000000000000-----`
- ex) (h=1가정)
- `(h << 5) : 00000000000000000000000000100000`
- `이거 두개 | 연산`
- `h = (int)(k.charAt(i)* Math.pow(a, k.length()-i-1));`
- 문자열을 해쉬코드로 만들 때, 각각의 char 곱해줘서 만들어라. + 자리수 다르게 하기 위해서 곱해주는 지수 값에 변화를 줌

## 실습 2

#### 앞의 실습에서 구현한 MyHashTable에 다음의 조건에 맞게 새로운 기능을 추가 구현하시오

#### 구현조건

- MyHashTable에 data가 추가되거나 삭제될 대마다 load factor를 계산하여 갱신하도록 수정하시오
- 새로 추가된 constructor는 hashtable의 초기 크기와 더불어 rehash를 수행하는 load factor의 기준값을 파라미터로 받아들임
- Hash table이 기준 load factor에 도달하는 경우 자동으로 크기(capacity)를 2배로 키워서 rehash하도록 구현할 것
- main() 함수를 작성하여 초기의 크기가 13이고 load factor가 0.9인 hash table을 생성하고 임의의 학생 15명을 연속으로 추가하여 rehash가 정상적으로 수행되는지 확인하시오

## MyHashTable.java

```java

package map;

import java.util.ArrayList;

public class MyHashTable {
	private ArrayList bucketArray; // Bucket Array
	private int bucketCapacity; // Bucket Size
	private int totalCnt; //
	private float loadFactor;

	// Constructor
	MyHashTable(int initialCapacity){
		bucketArray = new ArrayList(initialCapacity);
		this.bucketCapacity = initialCapacity;
		this.totalCnt = 0;

		//init
		for(int i=0; i<initialCapacity; i++) {
			this.bucketArray.add(null);
		}
	}

	MyHashTable(int initialCapacity, float loadFactor){
		this.bucketArray = new ArrayList();
		this.bucketCapacity = initialCapacity;
		this.loadFactor = loadFactor;
		this.totalCnt = 0;

		//init
		for(int i=0; i<initialCapacity; i++) {
			this.bucketArray.add(null);
		}
	}

	public float getLoadFactor() {
		return (float)this.totalCnt / this.bucketCapacity;
	}

	public void rehash(int capacity) {
		ArrayList oldList = this.bucketArray;

		//init
		this.bucketCapacity = capacity;
		this.bucketArray = new ArrayList();
		for(int i = 0 ; i <this.bucketCapacity; i++) {
			this.bucketArray.add(null);
		}
		this.totalCnt = 0 ;

		// reinsert old bucket object into new bucket
		for(int i=0; i < oldList.size(); i++) {
			ArrayList temp = (ArrayList)oldList.get(i);
			if(temp != null) {
				for(int j = 0; j<temp.size(); j++) {
					StudentInfo tempStudentInfo = (StudentInfo)temp.get(j);
					this.put(tempStudentInfo.getStudentID(), tempStudentInfo.getStudentName());
				}
			}
		}
	}
	//Implement the following methods
	private int hashFunc(String k) {
		int h = 0 ;
		int a = 33;

		//generation
		for(int i = 0 ; i < k.length(); i++){
			h = (h << 5) | (h >>> 27);
			h = (int)(k.charAt(i)* Math.pow(a, k.length()-i-1));
		}

		//compression
		h = h % this.bucketCapacity;

		return h;
	}
	public int size() {
		return this.totalCnt;
	}
	public String get(String k) {
		//k를 검색해서 해당 value 값을 리턴하는 함수!

		int key = this.hashFunc(k);
		String result = null;
		ArrayList tempList = (ArrayList)this.bucketArray.get(key);

		if(tempList == null) {
			System.out.println("this key is empty!");
		}
		else {
			for(int i=0; i < tempList.size(); i++) {
				StudentInfo temp = (StudentInfo)tempList.get(i);
				if(k.equals(temp.getStudentID())) {
					result = temp.getStudentName();
				}
			}
		}

		return result;
	}

	public String put(String k, String v) {
		//k가 처음 들어온 거라면, entry를 insert
		//k가 중복된 거라면 ->entry insert 후 oldValue return

		if(this.getLoadFactor() > this.loadFactor) {
			this.rehash(this.bucketCapacity*2);
		}

		StudentInfo newStudent = new StudentInfo(k,v);
		int key = this.hashFunc(k);

		ArrayList tempList = (ArrayList)this.bucketArray.get(key);

		this.totalCnt++;

		if(tempList == null) {
			//make list and put object
			ArrayList newList = new ArrayList();
			newList.add(newStudent);
			this.bucketArray.set(key, newList);
			return null;
		}
		else {
			//already exist object in key
			tempList.add(newStudent);
			StudentInfo temp = (StudentInfo)tempList.get(0);
			return temp.getStudentName();
			// 변경해주는게 아니라 그냥 추가해주고 이전 value 리턴해줄 뿐
		}
	}


	public String remove(String k) {
		int key = this.hashFunc(k);
		String result = null;

		ArrayList tempList = (ArrayList)this.bucketArray.get(key);

		if(tempList == null) {
			// no object
			System.out.println("this key is empty!");
		}
		else {
			for(int i = 0 ; i < tempList.size(); i++) {
				StudentInfo temp = (StudentInfo)tempList.get(i);

				if(k.equals(temp.getStudentID())) {
					StudentInfo removeStudent = (StudentInfo) (tempList).remove(i);
					result = removeStudent.getStudentName();
					this.totalCnt--;
					}
				}
			}
		return result;
	}

	public void printHashTable() {
		System.out.println("**********HASH TABLE ***********");
		System.out.println("CAPACITY : " + this.bucketCapacity + ", Size: " + this.totalCnt + ", LoadFactor : " + this.loadFactor);

		for(int i = 0 ; i < this.bucketArray.size(); i++) {
			ArrayList tempList = (ArrayList)this.bucketArray.get(i);
			if(tempList == null) {
				System.out.println("[ 0 ]");
			}
			else {
				System.out.print("[ " + tempList.size() + " ] - ");
				for(int j = 0 ; j < tempList.size(); j++) {
					StudentInfo temp = (StudentInfo)tempList.get(j);
					System.out.print(temp.getStudentName() + " ");
				}
				System.out.println();
			}
		}
	}

}


```

## Main.java

```java

package map;

public class Main {

	public static void main(String[] args) {

		MyHashTable mht = new MyHashTable(13,0.9F);

		//put test

		System.out.println("----------------------------------------");
		System.out.println(mht.put("201211032","HSK"));
		System.out.println(mht.put("202111032","HSK2"));
		System.out.println(mht.put("201211111","KDI"));
		System.out.println(mht.put("201211115","KDP"));
		System.out.println(mht.put("201211215","DDP"));
		System.out.println(mht.put("201211515","GDP"));
		System.out.println("current loadfactor: " + mht.getLoadFactor());

		System.out.println(mht.put("201911515","LID"));
		System.out.println(mht.put("201911528","HID"));
		System.out.println(mht.put("201911529","YID"));
		System.out.println(mht.put("201911530","YKD"));
		System.out.println(mht.put("201911560","YHD"));
		System.out.println("current loadfactor: " + mht.getLoadFactor());

		// get test
		System.out.println("----------------------------------------");
		System.out.println("get 201211032 : " + mht.get("201211032"));
		System.out.println("get 201211111 : " + mht.get("201211111"));

		// print test
		mht.printHashTable();

		// rehash test
		System.out.println("----------------------------------------");
		System.out.println(mht.put("201912515","JID"));
		System.out.println(mht.put("201211528", "IJD"));
		System.out.println(mht.put("201916529", "YIJ"));
		System.out.println(mht.put("201917530","QKD"));
		System.out.println(mht.put("201211560", "YHD"));
		System.out.println("cureent loadfactor : " + mht.getLoadFactor());


		//print test
		mht.printHashTable();

		//remove test
		System.out.println("----------------------------------------");
		System.out.println("remove 201211032 : " + mht.remove("201211032"));
		System.out.println("remove 201211528 : " + mht.remove("201211528"));

		//print test
		mht.printHashTable();
	}

}


```

---

하영국 교수님 자바 수업
